ç›®å½•

# æ–°å»ºæœåŠ¡

æœ¬ç« èŠ‚ï¼Œå°†ä»‹ç»å¦‚ä½•æ–°å»ºåå­—ä¸º `yudao-module-demo` çš„ç¤ºä¾‹æœåŠ¡ï¼Œå¹¶æ·»åŠ  RESTful API æ¥å£ã€‚

è™½ç„¶å†…å®¹çœ‹èµ·æ¥æ¯”è¾ƒé•¿ï¼Œæ˜¯å› ä¸ºè‰¿è‰¿å†™çš„æ¯”è¾ƒè¯¦ç»†ï¼Œå¤§é‡æˆªå›¾ï¼Œä¿å§†çº§æ•™ç¨‹ï¼å…¶å®åªæœ‰ 6 ä¸ªæ­¥éª¤ï¼Œä¿æŒè€å¿ƒï¼Œè·Ÿç€è‰¿è‰¿ä¸€ç‚¹ç‚¹æ¥ã€‚ğŸ™‚ å®Œæˆä¹‹åï¼Œä½ ä¼šå¯¹æ•´ä¸ª [é¡¹ç›®ç»“æ„](/project-intro/) æœ‰æ›´å……åˆ†çš„äº†è§£ã€‚

## [#](#ğŸ‘-ç›¸å…³è§†é¢‘æ•™ç¨‹) ğŸ‘ ç›¸å…³è§†é¢‘æ•™ç¨‹

*   [ä»é›¶å¼€å§‹ 06ï¼šå¦‚ä½• 5 åˆ†é’Ÿï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—ï¼Ÿ (opens new window)](https://t.zsxq.com/07EUrZrNV) ã€è¯¥è§†é¢‘æ˜¯ Boot å•ä½“ç‰ˆï¼ŒCloud å¾…å½•åˆ¶ã€‘

## [#](#_1-æ–°å»º-demo-æ¨¡å—) 1. æ–°å»º demo æ¨¡å—

â‘  é€‰æ‹© File -> New -> Module èœå•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![æ‰“å¼€ New Module](./static/40.png)

â‘¡ é€‰æ‹© Maven ç±»å‹ï¼Œé€‰æ‹©çˆ¶æ¨¡å—ä¸º `yudao`ï¼Œè¾“å…¥åå­—ä¸º `yudao-module-demo`ï¼Œå¹¶ç‚¹å‡» Create æŒ‰é’®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![å¡«å†™ Module ä¿¡æ¯](./static/42.png)

â‘¢ æ‰“å¼€ `yudao-module-demo` æ¨¡å—ï¼Œåˆ é™¤ src æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![åˆ é™¤ src æ–‡ä»¶](./static/43.png)

â‘£ æ‰“å¼€ `yudao-module-demo` æ¨¡å—çš„ `pom.xml` æ–‡ä»¶ï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š

æç¤º

`<!-- -->` éƒ¨åˆ†ï¼Œåªæ˜¯æ³¨é‡Šï¼Œä¸éœ€è¦å†™åˆ° XML ä¸­ã€‚

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>yudao</artifactId>
        <groupId>cn.iocoder.cloud</groupId>
        <version>${revision}</version> <!-- 1. ä¿®æ”¹ version ä¸º ${revision} -->
    </parent>
    <modelVersion>4.0.0</modelVersion>

    <artifactId>yudao-module-demo</artifactId>
    <packaging>pom</packaging> <!-- 2. æ–°å¢ packaging ä¸º pom -->

    <name>${project.artifactId}</name> <!-- 3. æ–°å¢ name ä¸º ${project.artifactId} -->
    <description> <!-- 4. æ–°å¢ description ä¸ºè¯¥æ¨¡å—çš„æè¿° -->
        demo æ¨¡å—ï¼Œä¸»è¦å®ç° XXXã€YYYã€ZZZ ç­‰åŠŸèƒ½ã€‚
    </description>

</project>

```

## [#](#_2-æ–°å»º-demo-api-å­æ¨¡å—) 2. æ–°å»º demo-api å­æ¨¡å—

â‘  æ–°å»º `yudao-module-demo-api` å­æ¨¡å—ï¼Œæ•´ä¸ªè¿‡ç¨‹å’Œâ€œæ–°å»º demo æ¨¡å—â€æ˜¯ä¸€è‡´çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![æ‰“å¼€ New Module](./static/40.png)

![å¡«å†™ Module ä¿¡æ¯](./static/42-api.png)

â‘¡ æ‰“å¼€ `yudao-module-demo-api` æ¨¡å—çš„ `pom.xml` æ–‡ä»¶ï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>yudao-module-demo</artifactId>
        <groupId>cn.iocoder.cloud</groupId>
        <version>${revision}</version> <!-- 1. ä¿®æ”¹ version ä¸º ${revision} -->
    </parent>
    <modelVersion>4.0.0</modelVersion>
    <artifactId>yudao-module-demo-api</artifactId>
    <packaging>jar</packaging> <!-- 2. æ–°å¢ packaging ä¸º jar -->

    <name>${project.artifactId}</name> <!-- 3. æ–°å¢ name ä¸º ${project.artifactId} -->
    <description> <!-- 4. æ–°å¢ description ä¸ºè¯¥æ¨¡å—çš„æè¿° -->
        demo æ¨¡å— APIï¼Œæš´éœ²ç»™å…¶å®ƒæ¨¡å—è°ƒç”¨
    </description>

    <dependencies>  <!-- 5. æ–°å¢ yudao-common ä¾èµ– -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-common</artifactId>
        </dependency>
    </dependencies>

</project>

```

â‘¢ ã€å¯é€‰ã€‘æ–°å»º `cn.iocoder.yudao.module.demo` **åŸºç¡€**åŒ…ï¼Œå…¶ä¸­ `demo` ä¸ºæ¨¡å—åã€‚ä¹‹åï¼Œæ–°å»º `api` å’Œ `enums` åŒ…ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![æ–°å»ºåŸºç¡€åŒ…](./static/44.png)

## [#](#_3-æ–°å»º-demo-biz-å­æ¨¡å—) 3. æ–°å»º demo-biz å­æ¨¡å—

â‘  æ–°å»º `yudao-module-demo-biz` å­æ¨¡å—ï¼Œæ•´ä¸ªè¿‡ç¨‹å’Œâ€œæ–°å»º demo æ¨¡å—â€ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![æ‰“å¼€ New Module](./static/40.png)

![å¡«å†™ Module ä¿¡æ¯](./static/42-biz.png)

â‘¡ æ‰“å¼€ `yudao-module-demo-biz` æ¨¡å—çš„ `pom.xml` æ–‡ä»¶ï¼Œä¿®æ”¹æˆå†…å®¹å¦‚ä¸‹ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>yudao-module-demo</artifactId>
        <groupId>cn.iocoder.cloud</groupId>
        <version>${revision}</version> <!-- 1. ä¿®æ”¹ version ä¸º ${revision} -->
    </parent>
    <modelVersion>4.0.0</modelVersion>
    <packaging>jar</packaging> <!-- 2. æ–°å¢ packaging ä¸º jar -->

    <artifactId>yudao-module-demo-biz</artifactId>

    <name>${project.artifactId}</name> <!-- 3. æ–°å¢ name ä¸º ${project.artifactId} -->
    <description> <!-- 4. æ–°å¢ description ä¸ºè¯¥æ¨¡å—çš„æè¿° -->
        demo æ¨¡å—ï¼Œä¸»è¦å®ç° XXXã€YYYã€ZZZ ç­‰åŠŸèƒ½ã€‚
    </description>

    <dependencies>  <!-- 5. æ–°å¢ä¾èµ–ï¼Œè¿™é‡Œå¼•å…¥çš„éƒ½æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸šåŠ¡ç»„ä»¶ã€æŠ€æœ¯ç»„ä»¶ -->
        <!-- Spring Cloud åŸºç¡€ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-env</artifactId>
        </dependency>

        <!-- ä¾èµ–æœåŠ¡ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-module-system-api</artifactId>
            <version>${revision}</version>
        </dependency>
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-module-infra-api</artifactId>
            <version>${revision}</version>
        </dependency>

        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-module-demo-api</artifactId>
            <version>${revision}</version>
        </dependency>

        <!-- ä¸šåŠ¡ç»„ä»¶ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-biz-data-permission</artifactId>
        </dependency>
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-biz-tenant</artifactId>
        </dependency>

        <!-- Web ç›¸å…³ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-web</artifactId>
        </dependency>

        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-security</artifactId>
        </dependency>

        <!-- DB ç›¸å…³ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-mybatis</artifactId>
        </dependency>

        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-redis</artifactId>
        </dependency>

        <!-- RPC è¿œç¨‹è°ƒç”¨ç›¸å…³ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-rpc</artifactId>
        </dependency>

        <!-- Registry æ³¨å†Œä¸­å¿ƒç›¸å…³ -->
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
        </dependency>

        <!-- Config é…ç½®ä¸­å¿ƒç›¸å…³ -->
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
        </dependency>

        <!-- Job å®šæ—¶ä»»åŠ¡ç›¸å…³ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-job</artifactId>
        </dependency>

        <!-- æ¶ˆæ¯é˜Ÿåˆ—ç›¸å…³ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-mq</artifactId>
        </dependency>

        <!-- Test æµ‹è¯•ç›¸å…³ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-test</artifactId>
        </dependency>

        <!-- å·¥å…·ç±»ç›¸å…³ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-excel</artifactId>
        </dependency>

        <!-- ç›‘æ§ç›¸å…³ -->
        <dependency>
            <groupId>cn.iocoder.cloud</groupId>
            <artifactId>yudao-spring-boot-starter-monitor</artifactId>
        </dependency>
    </dependencies>

    <build>
        <!-- è®¾ç½®æ„å»ºçš„ jar åŒ…å -->
        <finalName>${project.artifactId}</finalName>
        <plugins>
            <!-- æ‰“åŒ… -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <version>${spring.boot.version}</version>
                <configuration>
                    <fork>true</fork>
                </configuration>
                <executions>
                    <execution>
                        <goals>
                            <goal>repackage</goal> <!-- å°†å¼•å…¥çš„ jar æ‰“å…¥å…¶ä¸­ -->
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project>

```

â‘¢ ã€å¿…é€‰ã€‘æ–°å»º `cn.iocoder.yudao.module.demo` **åŸºç¡€**åŒ…ï¼Œå…¶ä¸­ `demo` ä¸ºæ¨¡å—åã€‚ä¹‹åï¼Œæ–°å»º `controller.admin` å’Œ `controller.user` ç­‰åŒ…ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![æ–°å»ºåŸºç¡€åŒ…](./static/45.png)

å‹æƒ…æç¤ºï¼š

æ³¨æ„ï¼ã€JDK 17 + Spring Boot 3.X ç‰ˆæœ¬ã€‘å’Œã€JDK 8 + Spring Boot 2.X ç‰ˆæœ¬ã€‘çš„ä»£ç ç•¥æœ‰ä¸åŒï¼Œä¸‹é¢ä¼šåˆ†åˆ«å±•ç¤ºã€‚

ã€JDK 17 + Spring Boot 3.X ç‰ˆæœ¬ã€‘å…¶ä¸­ SecurityConfiguration çš„ Java ä»£ç å¦‚ä¸‹ï¼š

```java
package cn.iocoder.yudao.module.demo.framework.security.config;

import cn.iocoder.yudao.framework.security.config.AuthorizeRequestsCustomizer;
import cn.iocoder.yudao.module.infra.enums.ApiConstants;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configurers.AuthorizeHttpRequestsConfigurer;

/**
 * Demo æ¨¡å—çš„ Security é…ç½®
 */
@Configuration(proxyBeanMethods = false)
public class SecurityConfiguration {

    @Bean
    public AuthorizeRequestsCustomizer authorizeRequestsCustomizer() {
        return new AuthorizeRequestsCustomizer() {

            @Override
            public void customize(ExpressionUrlAuthorizationConfigurer<HttpSecurity>.ExpressionInterceptUrlRegistry registry) {
                // Swagger æ¥å£æ–‡æ¡£
                registry.requestMatchers("/v3/api-docs/**").permitAll()
                        .requestMatchers("/webjars/**").permitAll()
                        .requestMatchers("/swagger-ui").permitAll()
                        .requestMatchers("/swagger-ui/**").permitAll();
                // Druid ç›‘æ§
                registry.requestMatchers("/druid/**").permitAll();
                // Spring Boot Actuator çš„å®‰å…¨é…ç½®
                registry.requestMatchers("/actuator").permitAll()
                        .requestMatchers("/actuator/**").permitAll();
                // RPC æœåŠ¡çš„å®‰å…¨é…ç½®
                registry.requestMatchers(ApiConstants.PREFIX + "/**").permitAll();
            }

        };
    }

}

```

ã€JDK 8 + Spring Boot 2.X ç‰ˆæœ¬ã€‘å…¶ä¸­ SecurityConfiguration çš„ Java ä»£ç å¦‚ä¸‹ï¼š

```java
package cn.iocoder.yudao.module.demo.framework.security.config;

import cn.iocoder.yudao.framework.security.config.AuthorizeRequestsCustomizer;
import cn.iocoder.yudao.module.system.enums.ApiConstants;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configurers.ExpressionUrlAuthorizationConfigurer;

/**
 * Demo æ¨¡å—çš„ Security é…ç½®
 */
@Configuration(proxyBeanMethods = false)
public class SecurityConfiguration {

    @Bean
    public AuthorizeRequestsCustomizer authorizeRequestsCustomizer() {
        return new AuthorizeRequestsCustomizer() {

            @Override
            public void customize(ExpressionUrlAuthorizationConfigurer<HttpSecurity>.ExpressionInterceptUrlRegistry registry) {
                // Swagger æ¥å£æ–‡æ¡£
                registry.antMatchers("/v3/api-docs/**").permitAll()
                        .antMatchers("/webjars/**").permitAll()
                        .antMatchers("/swagger-ui").permitAll()
                        .antMatchers("/swagger-ui/**").permitAll();
                // Druid ç›‘æ§
                registry.antMatchers("/druid/**").anonymous();
                // Spring Boot Actuator çš„å®‰å…¨é…ç½®
                registry.antMatchers("/actuator").anonymous()
                        .antMatchers("/actuator/**").anonymous();
                // RPC æœåŠ¡çš„å®‰å…¨é…ç½®
                registry.antMatchers(ApiConstants.PREFIX + "/**").permitAll();
            }

        };
    }

}

```

å…¶ä¸­ DemoServerApplication çš„ Java ä»£ç å¦‚ä¸‹ï¼š

```java
package cn.iocoder.yudao.module.demo;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

/**
 * é¡¹ç›®çš„å¯åŠ¨ç±»
 *
 * @author èŠ‹é“æºç 
 */
@SpringBootApplication
public class DemoServerApplication {

    public static void main(String[] args) {
        SpringApplication.run(DemoServerApplication.class, args);
    }

}

```

â‘£ æ‰“å¼€ Maven èœå•ï¼Œç‚¹å‡»åˆ·æ–°æŒ‰é’®ï¼Œè®©å¼•å…¥çš„ Maven ä¾èµ–ç”Ÿæ•ˆã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![åˆ·æ–° Maven ä¾èµ–](./static/46.png)

â‘¤ åœ¨ `resources` ç›®å½•ä¸‹ï¼Œæ–°å»ºé…ç½®æ–‡ä»¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![é…ç½®æ–‡ä»¶](./static/101.png)

å…¶ä¸­ `application.yml` çš„é…ç½®å¦‚ä¸‹ï¼š

```yaml
spring:
  application:
  name: demo-server

  profiles:
    active: local
  
  main:
    allow-circular-references: true # å…è®¸å¾ªç¯ä¾èµ–ï¼Œå› ä¸ºé¡¹ç›®æ˜¯ä¸‰å±‚æ¶æ„ï¼Œæ— æ³•é¿å…è¿™ä¸ªæƒ…å†µã€‚
    allow-bean-definition-overriding: true # å…è®¸ Bean è¦†ç›–ï¼Œä¾‹å¦‚è¯´ Feign ç­‰ä¼šå­˜åœ¨é‡å¤å®šä¹‰çš„æœåŠ¡

  config:
    import:
      - optional:classpath:application-${spring.profiles.active}.yaml # åŠ è½½ã€æœ¬åœ°ã€‘é…ç½®
      - optional:nacos:${spring.application.name}-${spring.profiles.active}.yaml # åŠ è½½ã€Nacosã€‘çš„é…ç½®

  # Servlet é…ç½®
  servlet:
    # æ–‡ä»¶ä¸Šä¼ ç›¸å…³é…ç½®é¡¹
    multipart:
      max-file-size: 16MB # å•ä¸ªæ–‡ä»¶å¤§å°
      max-request-size: 32MB # è®¾ç½®æ€»ä¸Šä¼ çš„æ–‡ä»¶å¤§å°

  # Jackson é…ç½®é¡¹
  jackson:
    serialization:
      write-dates-as-timestamps: true # è®¾ç½® LocalDateTime çš„æ ¼å¼ï¼Œä½¿ç”¨æ—¶é—´æˆ³
      write-date-timestamps-as-nanoseconds: false # è®¾ç½®ä¸ä½¿ç”¨ nanoseconds çš„æ ¼å¼ã€‚ä¾‹å¦‚è¯´ 1611460870.401ï¼Œè€Œæ˜¯ç›´æ¥ 1611460870401
      write-durations-as-timestamps: true # è®¾ç½® Duration çš„æ ¼å¼ï¼Œä½¿ç”¨æ—¶é—´æˆ³
      fail-on-empty-beans: false # å…è®¸åºåˆ—åŒ–æ— å±æ€§çš„ Bean

  # Cache é…ç½®é¡¹
  cache:
    type: REDIS
    redis:
      time-to-live: 1h # è®¾ç½®è¿‡æœŸæ—¶é—´ä¸º 1 å°æ—¶

server:
  port: 48099

logging:
  file:
    name: ${user.home}/logs/${spring.application.name}.log # æ—¥å¿—æ–‡ä»¶åï¼Œå…¨è·¯å¾„

--- #################### æ¥å£æ–‡æ¡£é…ç½® ####################

springdoc:
  api-docs:
    enabled: true # 1. æ˜¯å¦å¼€å¯ Swagger æ¥æ–‡æ¡£çš„å…ƒæ•°æ®
    path: /v3/api-docs
  swagger-ui:
    enabled: true # 2.1 æ˜¯å¦å¼€å¯ Swagger æ–‡æ¡£çš„å®˜æ–¹ UI ç•Œé¢
    path: /swagger-ui.html
  default-flat-param-object: true # å‚è§ https://doc.xiaominfo.com/docs/faq/v4/knife4j-parameterobject-flat-param æ–‡æ¡£

knife4j:
  enable: true # 2.2 æ˜¯å¦å¼€å¯ Swagger æ–‡æ¡£çš„ Knife4j UI ç•Œé¢
  setting:
    language: zh_cn

# MyBatis Plus çš„é…ç½®é¡¹
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true # è™½ç„¶é»˜è®¤ä¸º true ï¼Œä½†æ˜¯è¿˜æ˜¯æ˜¾ç¤ºå»æŒ‡å®šä¸‹ã€‚
  global-config:
    db-config:
      id-type: NONE # â€œæ™ºèƒ½â€æ¨¡å¼ï¼ŒåŸºäº IdTypeEnvironmentPostProcessor + æ•°æ®æºçš„ç±»å‹ï¼Œè‡ªåŠ¨é€‚é…æˆ AUTOã€INPUT æ¨¡å¼ã€‚
      #      id-type: AUTO # è‡ªå¢ IDï¼Œé€‚åˆ MySQL ç­‰ç›´æ¥è‡ªå¢çš„æ•°æ®åº“
      #      id-type: INPUT # ç”¨æˆ·è¾“å…¥ IDï¼Œé€‚åˆ Oracleã€PostgreSQLã€Kingbaseã€DB2ã€H2 æ•°æ®åº“
      #      id-type: ASSIGN_ID # åˆ†é… IDï¼Œé»˜è®¤ä½¿ç”¨é›ªèŠ±ç®—æ³•ã€‚æ³¨æ„ï¼ŒOracleã€PostgreSQLã€Kingbaseã€DB2ã€H2 æ•°æ®åº“æ—¶ï¼Œéœ€è¦å»é™¤å®ä½“ç±»ä¸Šçš„ @KeySequence æ³¨è§£
      logic-delete-value: 1 # é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º 1)
      logic-not-delete-value: 0 # é€»è¾‘æœªåˆ é™¤å€¼(é»˜è®¤ä¸º 0)
    banner: false # å…³é—­æ§åˆ¶å°çš„ Banner æ‰“å°
  type-aliases-package: ${yudao.info.base-package}.module.*.dal.dataobject
  encryptor:
    password: XDV71a+xqStEA3WH # åŠ è§£å¯†çš„ç§˜é’¥ï¼Œå¯ä½¿ç”¨ https://www.imaegoo.com/2020/aes-key-generator/ ç½‘ç«™ç”Ÿæˆ

mybatis-plus-join:
  banner: false # å…³é—­æ§åˆ¶å°çš„ Banner æ‰“å°

# VO è½¬æ¢ï¼ˆæ•°æ®ç¿»è¯‘ï¼‰ç›¸å…³
easy-trans:
  is-enable-global: true # å¯ç”¨å…¨å±€ç¿»è¯‘ï¼ˆæ‹¦æˆªæ‰€æœ‰ SpringMVC ResponseBody è¿›è¡Œè‡ªåŠ¨ç¿»è¯‘ )ã€‚å¦‚æœå¯¹äºæ€§èƒ½è¦æ±‚å¾ˆé«˜å¯å…³é—­æ­¤é…ç½®ï¼Œæˆ–é€šè¿‡ @IgnoreTrans å¿½ç•¥æŸä¸ªæ¥å£

--- #################### RPC è¿œç¨‹è°ƒç”¨ç›¸å…³é…ç½® ####################

--- #################### MQ æ¶ˆæ¯é˜Ÿåˆ—ç›¸å…³é…ç½® ####################

--- #################### å®šæ—¶ä»»åŠ¡ç›¸å…³é…ç½® ####################

xxl:
  job:
    executor:
      appname: ${spring.application.name} # æ‰§è¡Œå™¨ AppName
      logpath: ${user.home}/logs/xxl-job/${spring.application.name} # æ‰§è¡Œå™¨è¿è¡Œæ—¥å¿—æ–‡ä»¶å­˜å‚¨ç£ç›˜è·¯å¾„
    accessToken: default_token # æ‰§è¡Œå™¨é€šè®¯TOKEN

--- #################### èŠ‹é“ç›¸å…³é…ç½® ####################

yudao:
  info:
    version: 1.0.0
    base-package: cn.iocoder.yudao.module.demo
  web:
    admin-ui:
      url: http://dashboard.yudao.iocoder.cn # Admin ç®¡ç†åå° UI çš„åœ°å€
  xss:
    enable: false
    exclude-urls: # å¦‚ä¸‹ä¸¤ä¸ª urlï¼Œä»…ä»…æ˜¯ä¸ºäº†æ¼”ç¤ºï¼Œå»æ‰é…ç½®ä¹Ÿæ²¡å…³ç³»
      - ${spring.boot.admin.context-path}/** # ä¸å¤„ç† Spring Boot Admin çš„è¯·æ±‚
      - ${management.endpoints.web.base-path}/** # ä¸å¤„ç† Actuator çš„è¯·æ±‚
  swagger:
    title: ç®¡ç†åå°
    description: æä¾›ç®¡ç†å‘˜ç®¡ç†çš„æ‰€æœ‰åŠŸèƒ½
    version: ${yudao.info.version}
  tenant: # å¤šç§Ÿæˆ·ç›¸å…³é…ç½®é¡¹
    enable: true

debug: false

```

*   `spring.application.name` é…ç½®é¡¹ï¼šå¯ä»¥æ”¹æˆä½ æƒ³è¦çš„æœåŠ¡åã€‚
*   `server.port` é…ç½®é¡¹ï¼šå¯ä»¥æ”¹æˆä½ æƒ³è¦çš„ç«¯å£å·ã€‚
*   `yudao.info.version.base-package` é…ç½®é¡¹ï¼šå¯ä»¥æ”¹æˆä½ çš„é¡¹ç›®çš„åŸºå‡†åŒ…åã€‚

å…¶ä¸­ `application-local.yml` çš„é…ç½®å¦‚ä¸‹ï¼š

```yaml
--- #################### æ•°æ®åº“ç›¸å…³é…ç½® ####################
spring:
  # æ•°æ®æºé…ç½®é¡¹
  autoconfigure:
    exclude:
      - com.alibaba.druid.spring.boot.autoconfigure.DruidDataSourceAutoConfigure # æ’é™¤ Druid çš„è‡ªåŠ¨é…ç½®ï¼Œä½¿ç”¨ dynamic-datasource-spring-boot-starter é…ç½®å¤šæ•°æ®æº
      - de.codecentric.boot.admin.client.config.SpringBootAdminClientAutoConfiguration # ç¦ç”¨ Spring Boot Admin çš„ Client çš„è‡ªåŠ¨é…ç½®
  datasource:
    druid: # Druid ã€ç›‘æ§ã€‘ç›¸å…³çš„å…¨å±€é…ç½®
      web-stat-filter:
        enabled: true
      stat-view-servlet:
        enabled: true
        allow: # è®¾ç½®ç™½åå•ï¼Œä¸å¡«åˆ™å…è®¸æ‰€æœ‰è®¿é—®
        url-pattern: /druid/*
        login-username: # æ§åˆ¶å°ç®¡ç†ç”¨æˆ·åå’Œå¯†ç 
        login-password:
      filter:
        stat:
          enabled: true
          log-slow-sql: true # æ…¢ SQL è®°å½•
          slow-sql-millis: 100
          merge-sql: true
        wall:
          config:
            multi-statement-allow: true
    dynamic: # å¤šæ•°æ®æºé…ç½®
      druid: # Druid ã€è¿æ¥æ± ã€‘ç›¸å…³çš„å…¨å±€é…ç½®
        initial-size: 1 # åˆå§‹è¿æ¥æ•°
        min-idle: 1 # æœ€å°è¿æ¥æ± æ•°é‡
        max-active: 20 # æœ€å¤§è¿æ¥æ± æ•°é‡
        max-wait: 600000 # é…ç½®è·å–è¿æ¥ç­‰å¾…è¶…æ—¶çš„æ—¶é—´ï¼Œå•ä½ï¼šæ¯«ç§’
        time-between-eviction-runs-millis: 60000 # é…ç½®é—´éš”å¤šä¹…æ‰è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œæ£€æµ‹éœ€è¦å…³é—­çš„ç©ºé—²è¿æ¥ï¼Œå•ä½ï¼šæ¯«ç§’
        min-evictable-idle-time-millis: 300000 # é…ç½®ä¸€ä¸ªè¿æ¥åœ¨æ± ä¸­æœ€å°ç”Ÿå­˜çš„æ—¶é—´ï¼Œå•ä½ï¼šæ¯«ç§’
        max-evictable-idle-time-millis: 900000 # é…ç½®ä¸€ä¸ªè¿æ¥åœ¨æ± ä¸­æœ€å¤§ç”Ÿå­˜çš„æ—¶é—´ï¼Œå•ä½ï¼šæ¯«ç§’
        validation-query: SELECT 1 FROM DUAL # é…ç½®æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆ
        test-while-idle: true
        test-on-borrow: false
        test-on-return: false
      primary: master
      datasource:
        master:
          url: jdbc:mysql://127.0.0.1:3306/ruoyi-vue-pro?useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true&nullCatalogMeansCurrent=true&rewriteBatchedStatements=true # MySQL Connector/J 8.X è¿æ¥çš„ç¤ºä¾‹
          #          url: jdbc:mysql://127.0.0.1:3306/ruoyi-vue-pro?useSSL=true&allowPublicKeyRetrieval=true&useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai&rewriteBatchedStatements=true # MySQL Connector/J 5.X è¿æ¥çš„ç¤ºä¾‹
          #          url: jdbc:postgresql://127.0.0.1:5432/ruoyi-vue-pro # PostgreSQL è¿æ¥çš„ç¤ºä¾‹
          #          url: jdbc:oracle:thin:@127.0.0.1:1521:xe # Oracle è¿æ¥çš„ç¤ºä¾‹
          #          url: jdbc:sqlserver://127.0.0.1:1433;DatabaseName=ruoyi-vue-pro # SQLServer è¿æ¥çš„ç¤ºä¾‹
          #          url: jdbc:dm://10.211.55.4:5236?schema=RUOYI_VUE_PRO # DM è¿æ¥çš„ç¤ºä¾‹
          username: root
          password: 123456
        #          username: sa # SQL Server è¿æ¥çš„ç¤ºä¾‹
        #          password: JSm:g(*%lU4ZAkz06cd52KqT3)i1?H7W # SQL Server è¿æ¥çš„ç¤ºä¾‹
        #          username: SYSDBA # DM è¿æ¥çš„ç¤ºä¾‹
        #          password: SYSDBA # DM è¿æ¥çš„ç¤ºä¾‹
        slave: # æ¨¡æ‹Ÿä»åº“ï¼Œå¯æ ¹æ®è‡ªå·±éœ€è¦ä¿®æ”¹
          lazy: true # å¼€å¯æ‡’åŠ è½½ï¼Œä¿è¯å¯åŠ¨é€Ÿåº¦
          url: jdbc:mysql://127.0.0.1:3306/ruoyi-vue-pro?useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true&nullCatalogMeansCurrent=true&rewriteBatchedStatements=true
          username: root
          password: 123456

  # Redis é…ç½®ã€‚Redisson é»˜è®¤çš„é…ç½®è¶³å¤Ÿä½¿ç”¨ï¼Œä¸€èˆ¬ä¸éœ€è¦è¿›è¡Œè°ƒä¼˜
  redis:
    host: 127.0.0.1 # åœ°å€
    port: 6379 # ç«¯å£
    database: 0 # æ•°æ®åº“ç´¢å¼•
#    password: 123456 # å¯†ç ï¼Œå»ºè®®ç”Ÿäº§ç¯å¢ƒå¼€å¯

--- #################### MQ æ¶ˆæ¯é˜Ÿåˆ—ç›¸å…³é…ç½® ####################

--- #################### å®šæ—¶ä»»åŠ¡ç›¸å…³é…ç½® ####################

xxl:
  job:
    admin:
      addresses: http://127.0.0.1:9090/xxl-job-admin # è°ƒåº¦ä¸­å¿ƒéƒ¨ç½²è·Ÿåœ°å€

--- #################### æœåŠ¡ä¿éšœç›¸å…³é…ç½® ####################

# Lock4j é…ç½®é¡¹
lock4j:
  acquire-timeout: 3000 # è·å–åˆ†å¸ƒå¼é”è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º 3000 æ¯«ç§’
  expire: 30000 # åˆ†å¸ƒå¼é”çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º 30 æ¯«ç§’

--- #################### ç›‘æ§ç›¸å…³é…ç½® ####################

# Actuator ç›‘æ§ç«¯ç‚¹çš„é…ç½®é¡¹
management:
  endpoints:
    web:
      base-path: /actuator # Actuator æä¾›çš„ API æ¥å£çš„æ ¹ç›®å½•ã€‚é»˜è®¤ä¸º /actuator
      exposure:
        include: '*' # éœ€è¦å¼€æ”¾çš„ç«¯ç‚¹ã€‚é»˜è®¤å€¼åªæ‰“å¼€ health å’Œ info ä¸¤ä¸ªç«¯ç‚¹ã€‚é€šè¿‡è®¾ç½® * ï¼Œå¯ä»¥å¼€æ”¾æ‰€æœ‰ç«¯ç‚¹ã€‚

# Spring Boot Admin é…ç½®é¡¹
spring:
  boot:
    admin:
      # Spring Boot Admin Client å®¢æˆ·ç«¯çš„ç›¸å…³é…ç½®
      client:
        instance:
          service-host-type: IP # æ³¨å†Œå®ä¾‹æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ IP [IP, HOST_NAME, CANONICAL_HOST_NAME]

# æ—¥å¿—æ–‡ä»¶é…ç½®
logging:
  level:
    # é…ç½®è‡ªå·±å†™çš„ MyBatis Mapper æ‰“å°æ—¥å¿—
    cn.iocoder.yudao.module.demo.dal.mysql: debug
    org.springframework.context.support.PostProcessorRegistrationDelegate: ERROR # TODO èŠ‹è‰¿ï¼šå…ˆç¦ç”¨ï¼ŒSpring Boot 3.X å­˜åœ¨éƒ¨åˆ†é”™è¯¯çš„ WARN æç¤º

--- #################### èŠ‹é“ç›¸å…³é…ç½® ####################

# èŠ‹é“é…ç½®é¡¹ï¼Œè®¾ç½®å½“å‰é¡¹ç›®æ‰€æœ‰è‡ªå®šä¹‰çš„é…ç½®
yudao:
  env: # å¤šç¯å¢ƒçš„é…ç½®é¡¹
    tag: ${HOSTNAME}
  security:
    mock-enable: true
  access-log: # è®¿é—®æ—¥å¿—çš„é…ç½®é¡¹
    enable: false

```

*   `logging.level.cn.iocoder.yudao.module.demo.dal.mysql` é…ç½®é¡¹ï¼šå¯ä»¥æ”¹æˆä½ çš„é¡¹ç›®çš„åŸºå‡†åŒ…åã€‚

å…¶ä¸­ `logback-spring.xml` çš„é…ç½®å¦‚ä¸‹ï¼š

```xml
<configuration>
    <!-- å¼•ç”¨ Spring Boot çš„ logback åŸºç¡€é…ç½® -->
    <include resource="org/springframework/boot/logging/logback/defaults.xml" />
    <!-- å˜é‡ yudao.info.base-packageï¼ŒåŸºç¡€ä¸šåŠ¡åŒ… -->
    <springProperty scope="context" name="yudao.info.base-package" source="yudao.info.base-package"/>
    <!-- æ ¼å¼åŒ–è¾“å‡ºï¼š%d è¡¨ç¤ºæ—¥æœŸï¼Œ%X{tid} SkWalking é“¾è·¯è¿½è¸ªç¼–å·ï¼Œ%thread è¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º 5 ä¸ªå­—ç¬¦å®½åº¦ï¼Œ%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦ -->
    <property name="PATTERN_DEFAULT" value="%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}} | %highlight(${LOG_LEVEL_PATTERN:-%5p} ${PID:- }) | %boldYellow(%thread [%tid]) %boldGreen(%-40.40logger{39}) | %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}"/>

    <!-- æ§åˆ¶å° Appender -->
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">ã€€ã€€ã€€ã€€ã€€
        <encoder class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
            <layout class="org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout">
                <pattern>${PATTERN_DEFAULT}</pattern>
            </layout>
        </encoder>
    </appender>

    <!-- æ–‡ä»¶ Appender -->
    <!-- å‚è€ƒ Spring Boot çš„ file-appender.xml ç¼–å†™ -->
    <appender name="FILE"  class="ch.qos.logback.core.rolling.RollingFileAppender">
        <encoder class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
            <layout class="org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout">
                <pattern>${PATTERN_DEFAULT}</pattern>
            </layout>
        </encoder>
        <!-- æ—¥å¿—æ–‡ä»¶å -->
        <file>${LOG_FILE}</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
            <!-- æ»šåŠ¨åçš„æ—¥å¿—æ–‡ä»¶å -->
            <fileNamePattern>${LOGBACK_ROLLINGPOLICY_FILE_NAME_PATTERN:-${LOG_FILE}.%d{yyyy-MM-dd}.%i.gz}</fileNamePattern>
            <!-- å¯åŠ¨æœåŠ¡æ—¶ï¼Œæ˜¯å¦æ¸…ç†å†å²æ—¥å¿—ï¼Œä¸€èˆ¬ä¸å»ºè®®æ¸…ç† -->
            <cleanHistoryOnStart>${LOGBACK_ROLLINGPOLICY_CLEAN_HISTORY_ON_START:-false}</cleanHistoryOnStart>
            <!-- æ—¥å¿—æ–‡ä»¶ï¼Œåˆ°è¾¾å¤šå°‘å®¹é‡ï¼Œè¿›è¡Œæ»šåŠ¨ -->
            <maxFileSize>${LOGBACK_ROLLINGPOLICY_MAX_FILE_SIZE:-10MB}</maxFileSize>
            <!-- æ—¥å¿—æ–‡ä»¶çš„æ€»å¤§å°ï¼Œ0 è¡¨ç¤ºä¸é™åˆ¶ -->
            <totalSizeCap>${LOGBACK_ROLLINGPOLICY_TOTAL_SIZE_CAP:-0}</totalSizeCap>
            <!-- æ—¥å¿—æ–‡ä»¶çš„ä¿ç•™å¤©æ•° -->
            <maxHistory>${LOGBACK_ROLLINGPOLICY_MAX_HISTORY:-30}</maxHistory>
        </rollingPolicy>
    </appender>
    <!-- å¼‚æ­¥å†™å…¥æ—¥å¿—ï¼Œæå‡æ€§èƒ½ -->
    <appender name="ASYNC" class="ch.qos.logback.classic.AsyncAppender">
        <!-- ä¸ä¸¢å¤±æ—¥å¿—ã€‚é»˜è®¤çš„ï¼Œå¦‚æœé˜Ÿåˆ—çš„ 80% å·²æ»¡,åˆ™ä¼šä¸¢å¼ƒ TRACTã€DEBUGã€INFO çº§åˆ«çš„æ—¥å¿— -->
        <discardingThreshold>0</discardingThreshold>
        <!-- æ›´æ”¹é»˜è®¤çš„é˜Ÿåˆ—çš„æ·±åº¦ï¼Œè¯¥å€¼ä¼šå½±å“æ€§èƒ½ã€‚é»˜è®¤å€¼ä¸º 256 -->
        <queueSize>256</queueSize>
        <appender-ref ref="FILE"/>
    </appender>

    <!-- SkyWalking GRPC æ—¥å¿—æ”¶é›†ï¼Œå®ç°æ—¥å¿—ä¸­å¿ƒã€‚æ³¨æ„ï¼šSkyWalking 8.4.0 ç‰ˆæœ¬å¼€å§‹æ”¯æŒ -->
    <appender name="GRPC" class="org.apache.skywalking.apm.toolkit.log.logback.v1.x.log.GRPCLogClientAppender">
        <encoder class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
            <layout class="org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout">
                <pattern>${PATTERN_DEFAULT}</pattern>
            </layout>
        </encoder>
    </appender>

    <!-- æœ¬åœ°ç¯å¢ƒ -->
    <springProfile name="local">
        <root level="INFO">
            <appender-ref ref="STDOUT"/>
            <appender-ref ref="GRPC"/> <!-- æœ¬åœ°ç¯å¢ƒä¸‹ï¼Œå¦‚æœä¸æƒ³æ¥å…¥ SkyWalking æ—¥å¿—æœåŠ¡ï¼Œå¯ä»¥æ³¨é‡Šæ‰æœ¬è¡Œ -->
            <appender-ref ref="ASYNC"/>  <!-- æœ¬åœ°ç¯å¢ƒä¸‹ï¼Œå¦‚æœä¸æƒ³æ‰“å°æ—¥å¿—ï¼Œå¯ä»¥æ³¨é‡Šæ‰æœ¬è¡Œ -->
        </root>
    </springProfile>
    <!-- å…¶å®ƒç¯å¢ƒ -->
    <springProfile name="dev,test,stage,prod,default">
        <root level="INFO">
            <appender-ref ref="STDOUT"/>
            <appender-ref ref="ASYNC"/>
            <appender-ref ref="GRPC"/>
        </root>
    </springProfile>

</configuration>

```

## [#](#_4-æ–°å»º-restful-api-æ¥å£) 4. æ–°å»º RESTful API æ¥å£

â‘  åœ¨ `controller.admin` åŒ…ï¼Œæ–°å»ºä¸€ä¸ª DemoTestController ç±»ï¼Œå¹¶æ–°å»ºä¸€ä¸ª `/demo/test/get` æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š

```java
package cn.iocoder.yudao.module.demo.controller.admin;

import cn.iocoder.yudao.framework.common.pojo.CommonResult;
import io.swagger.v3.oas.annotations.tags.Tag;
import io.swagger.v3.oas.annotations.Operation;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import static cn.iocoder.yudao.framework.common.pojo.CommonResult.success;

@Tag(name = "ç®¡ç†åå° - Test")
@RestController
@RequestMapping("/demo/test")
@Validated
public class DemoTestController {

    @GetMapping("/get")
    @Operation(summary = "è·å– test ä¿¡æ¯")
    public CommonResult<String> get() {
        return success("true");
    }

}

```

**æ³¨æ„**ï¼Œ`/demo` æ˜¯è¯¥æ¨¡å—æ‰€æœ‰ RESTful API çš„åŸºç¡€è·¯å¾„ï¼Œ`/test` æ˜¯ Test åŠŸèƒ½çš„åŸºç¡€è·¯å¾„ã€‚

â‘  åœ¨ `controller.app` åŒ…ï¼Œæ–°å»ºä¸€ä¸ª AppDemoTestController ç±»ï¼Œå¹¶æ–°å»ºä¸€ä¸ª `/demo/test/get` æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š

```java
package cn.iocoder.yudao.module.demo.controller.app;

import cn.iocoder.yudao.framework.common.pojo.CommonResult;
import io.swagger.v3.oas.annotations.tags.Tag;
import io.swagger.v3.oas.annotations.Operation;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import static cn.iocoder.yudao.framework.common.pojo.CommonResult.success;

@Tag(name = "ç”¨æˆ· App - Test")
@RestController
@RequestMapping("/demo/test")
@Validated
public class AppDemoTestController {

    @GetMapping("/get")
    @Operation(summary = "è·å– test ä¿¡æ¯")
    public CommonResult<String> get() {
        return success("true");
    }

}

```

åœ¨ Controller çš„å‘½åä¸Šï¼Œé¢å¤–å¢åŠ  **App** ä½œä¸ºå‰ç¼€ï¼Œä¸€æ–¹é¢åŒºåˆ†æ˜¯ç®¡ç†åå°è¿˜æ˜¯ç”¨æˆ· App çš„ Controllerï¼Œå¦ä¸€æ–¹é¢é¿å… Spring Bean çš„åå­—å†²çªã€‚

å¯èƒ½ä½ ä¼šå¥‡æ€ªï¼Œè¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ª `/demo/test/get` æ¥å£ï¼Œä¼šä¸ä¼šå­˜åœ¨é‡å¤å¯¼è‡´å†²çªå‘¢ï¼Ÿç­”æ¡ˆï¼Œå½“ç„¶æ˜¯å¹¶ä¸ä¼šã€‚åŸå› æ˜¯ï¼š

*   `controller.admin` åŒ…ä¸‹çš„æ¥å£ï¼Œé»˜è®¤ä¼šå¢åŠ  `/admin-api`ï¼Œå³æœ€ç»ˆçš„è®¿é—®åœ°å€æ˜¯ `/admin-api/demo/test/get`
*   `controller.app` åŒ…ä¸‹çš„æ¥å£ï¼Œé»˜è®¤ä¼šå¢åŠ  `/app-api`ï¼Œå³æœ€ç»ˆçš„è®¿é—®åœ°å€æ˜¯ `/app-api/demo/test/get`

## [#](#_5-å¯åŠ¨-demo-æœåŠ¡) 5. å¯åŠ¨ demo æœåŠ¡

â‘  è¿è¡Œ SystemServerApplication ç±»ï¼Œå°† `system` æœåŠ¡å¯åŠ¨ã€‚è¿è¡Œ InfraServerApplication ç±»ï¼Œå°† `infra` æœåŠ¡å¯åŠ¨ã€‚

â‘¡ è¿è¡Œ DemoServerApplication ç±»ï¼Œå°†æ–°å»ºçš„ `demo` æœåŠ¡è¿›è¡Œå¯åŠ¨ã€‚å¯åŠ¨å®Œæˆåï¼Œä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ [http://127.0.0.1:48099/doc.html (opens new window)](http://127.0.0.1:48099/doc.html) åœ°å€ï¼Œè¿›å…¥è¯¥æœåŠ¡çš„ Swagger æ¥å£æ–‡æ¡£ã€‚

â‘¢ æ‰“å¼€â€œç®¡ç†åå° - Testâ€æ¥å£ï¼Œè¿›è¡Œ `/admin-api/demo/test/get` æ¥å£çš„è°ƒè¯•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![æµ‹è¯•  æ¥å£](./static/48.png)

â‘£ æ‰“å¼€â€œç”¨æˆ· App - Testâ€æ¥å£ï¼Œè¿›è¡Œ `/app-api/demo/test/get` æ¥å£çš„è°ƒè¯•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![æµ‹è¯•  æ¥å£](./static/49.png)

## [#](#_6-ç½‘å…³é…ç½®) 6. ç½‘å…³é…ç½®

â‘  æ‰“å¼€ `yudao-gateway` ç½‘å…³é¡¹ç›®çš„ `application.yml` é…ç½®æ–‡ä»¶ï¼Œå¢åŠ  `demo` æœåŠ¡çš„è·¯ç”±é…ç½®ã€‚ä»£ç å¦‚ä¸‹ï¼š

![ç½‘å…³è·¯ç”±é…ç½®](./static/102.png)

å‹æƒ…æç¤ºï¼šå›¾ä¸­çš„ /v2/ éƒ½æ”¹æˆ /v3/ï¼Œæˆ–è€…ä»¥ä¸‹é¢çš„æ–‡å­—ä¸ºå‡†ï¼ï¼ï¼

```yaml
        - id: demo-admin-api # è·¯ç”±çš„ç¼–å·
          uri: grayLb://demo-server
          predicates: # æ–­è¨€ï¼Œä½œä¸ºè·¯ç”±çš„åŒ¹é…æ¡ä»¶ï¼Œå¯¹åº” RouteDefinition æ•°ç»„
            - Path=/admin-api/demo/**
          filters:
            - RewritePath=/admin-api/demo/v3/api-docs, /v3/api-docs # é…ç½®ï¼Œä¿è¯è½¬å‘åˆ° /v2/api-docs
        - id: demo-app-api # è·¯ç”±çš„ç¼–å·
          uri: grayLb://demo-server
          predicates: # æ–­è¨€ï¼Œä½œä¸ºè·¯ç”±çš„åŒ¹é…æ¡ä»¶ï¼Œå¯¹åº” RouteDefinition æ•°ç»„
            - Path=/app-api/demo/**
          filters:
            - RewritePath=/app-api/demo/v3/api-docs, /v3/api-docs

```

```yaml
      - name: demo-server
        service-name: demo-server
        url: /admin-api/demo/v3/api-docs

```

â‘¡ è¿è¡Œ GatewayServerApplication ç±»ï¼Œå°† `gateway` ç½‘å…³æœåŠ¡å¯åŠ¨ã€‚

â‘¢ ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ [http://127.0.0.1:48080/doc.html (opens new window)](http://127.0.0.1:48080/doc.html) åœ°å€ï¼Œè¿›å…¥ç½‘å…³çš„ Swagger æ¥å£æ–‡æ¡£ã€‚ç„¶åï¼Œé€‰æ‹© `demo-server` æœåŠ¡ï¼Œå³å¯è¿›è¡Œ `/admin-api/demo/test/get` å’Œ `/app-api/demo/test/get` æ¥å£çš„è°ƒè¯•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![ç½‘å…³ Swagger æ¥å£æ–‡æ¡£](./static/103.png)